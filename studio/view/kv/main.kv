#:import asynckivy kivymd.utils.asynckivy

<ScreenMain>:
    md_bg_color: "#262626"

    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            type_height: "small"
            title: "Cam Live"
            md_bg_color: "#484848"
            left_action_items: [["home", lambda x: root.callWelcome(), "Home"]]
            right_action_items: [["plus-outline", lambda x: root.dialog_box_cam(), "Add Cam"], ["web", lambda x: app.callback(x), "Connexion"], ["cog-outline", lambda x: app.callback(x), "Param√®tre"], ["account-outline", lambda x: app.callback(x), "Compte"]]
        
        MDBoxLayout:
            orientation: "horizontal"

            MDBoxLayout:
                id: one_widget
                orientation: "vertical"
                md_bg_color: "#484848"
                spacing: "10dp"
                padding: "10dp"

                MDBoxLayout:
                    orientation: "vertical"
                    md_bg_color: "#676767"
                    adaptive_height: True
                    padding: "10dp"
                    spacing: "5dp"
                    pos_hint: {"center_y": .96}
                    size_hint_y: .15

                    MDBoxLayout:
                        orientation: "horizontal"
                        adaptive_height: True
                        padding: dp(5)
                        spacing: dp(5)

                        MDSpinner:  
                            id: spinner
                            size_hint: None, None
                            size: dp(20), dp(20)
                            pos_hint: {"center_x": .5, "center_y": .5}
                            active: False
                        
                        IconButtonAction:
                            id: list_camera
                            icon: "camera-outline"
                            icon_size: dp(20)
                            style: "tonal"
                            theme_bg_color: "Custom"
                            theme_icon_color: "Custom"
                            icon_color: "#4287f5"
                            pos_hint: {"center_y": .5}
                            on_release: app.listcamera()
                        
                        ClickableTextFieldRound:
                            id: lien
                            size_hint_x: None
                            width: "300dp"
                            hint_text: "lien source"
                            pos_hint: {"center_x": .5, "center_y": .5}
                            
                    MDBoxLayout:
                        orientation: "horizontal"
                        md_bg_color: "#676767"
                    
                        IconButtonAction:
                            id: microphone
                            icon: "microphone-outline"
                            icon_size: dp(15)
                            style: "tonal"
                            theme_bg_color: "Custom"
                            theme_icon_color: "Custom"
                            icon_color: "#4287f5"
                            on_release:
                                app.listaudio()
                        
                        MDLabel:
                            id: audio
                            text: "[color=#4287f5]Audio Cam 1[/color]"
                            # adaptive_height: True
                            font_size: dp(10)
                            size_hint_x: None
                            width: dp(80)
                            halign: "center"
                            valign: "center"
                            pos_hint: {"center_y": .7}
                            markup: True
                        
                        IconButtonAction:
                            id: shape
                            icon: "shape-outline"
                            icon_size: dp(15)
                            style: "tonal"
                            theme_bg_color: "Custom"
                            theme_icon_color: "Custom"
                            icon_color: "#4287f5"
                            on_release: app.listDropdown()    

                        MDLabel:
                            id: label_format
                            text: "[color=#4287f5]format[/color]"
                            # adaptive_height: True
                            font_size: dp(10)
                            size_hint_x: None
                            width: dp(80)
                            halign: "center"
                            valign: "center"
                            pos_hint: {"center_y": .7}
                            markup: True

                        IconButtonAction:
                            id: save
                            icon: "content-save-outline"
                            style: "tonal"
                            theme_bg_color: "Custom"
                            theme_icon_color: "Custom"
                            icon_color: "#4287f5"
                            icon_size: dp(15)
                            on_release:
                                app.camController.on_record()

                CardViewImage:
                    id: cardImage
                    camController: app.camController
                    pos_hint: {"center_x": .5, "center_y": .5}
                    size_hint: .9, .5

            MDBoxLayout:
                id: two_widget
                orientation: "vertical"
                md_bg_color: "#484848"

                MDBoxLayout:
                    id: box_video
                    md_bg_color: "#484848"
                    
                    MDScrollView:

                        MDGridLayout:
                            padding: dp(10)
                            spacing: dp(10)
                            size_hint_y: 1.5
                            cols: 2

                            CardScrollImage:



<CardViewImage>:
    md_bg_color: "#676767" #ffffff
    padding: "10dp"
    spacing: "5dp"
    radius: 24
    image: image
    lecture: lecture

    MDBoxLayout:
        md_bg_color: "#676767"
        orientation: "vertical"

        MDRelativeLayout:
            size_hint_y: None
            height: dp(10)

            MDCard:
                id: bage_image
                md_bg_color: "#fff000"
                size_hint: None, None
                width: dp(10)
                height: dp(10)
                radius: 24
                pos_hint:{"center_x": .94, "center_y": .5}

        Image:
            id: image
            source: "studio\\asset\\texture_image.jpg"
            size_hint: None, None
            width: root.width - dp(50)
            height: root.height - dp(75)
            pos_hint: {"center_x": .5, "center_y": .5}

        MDBoxLayout:
            orientation: "horizontal"
            md_bg_color: "#676767"
            radius: 24

            IconButtonAction:
                id: microphone
                icon: "microphone-off"
                size_hint_x: .1
                icon_size: dp(15)
                pos_hint:{"center_y": .5}
                style: "tonal"
                theme_bg_color: "Custom"
                theme_icon_color: "Custom"
                icon_color: "#4287f5"
                on_release:

            IconButtonAction:
                id: play
                icon: "play"
                size_hint_x: .1
                icon_size: dp(15)
                pos_hint:{"center_y": .5}
                style: "tonal"
                theme_bg_color: "Custom"
                theme_icon_color: "Custom"
                icon_color: "#4287f5"
                on_release:
                    asynckivy.start(root.camController.on_play()) if self.icon == "play" else root.camController.on_break()

            IconButtonAction:
                id: stop
                icon: "stop"
                size_hint_x: .1
                icon_size: dp(15)
                pos_hint:{"center_y": .5}
                style: "tonal"
                theme_bg_color: "Custom"
                theme_icon_color: "Custom"
                icon_color: "#4287f5"
                on_release:
                    root.camController.on_stop()

            MDLabel:
                id: lecture
                text: "[color=#ffffff]00:00:00[/color]"
                size_hint_x: .2
                pos_hint:{"center_y": .5}
                font_size: dp(12)
                markup: True



# <TabVideo>
#     app: app 

#     MDBoxLayout:
#         md_bg_color: "#676767"
#         orientation: "vertical"
#         pos_hint: {"center_y": .8}
#         adaptive_height: True
#         padding: "5dp"
#         size_hint_y: .1

#         MDBoxLayout:
#             orientation: "horizontal"
#             adaptive_height: True
#             spacing: "5dp"

#             IconButtonAction:
#                 icon: "video-plus-outline"
#                 icon_size: dp(20)
#                 style: "tonal"
#                 theme_bg_color: "Custom"
#                 theme_icon_color: "Custom"
#                 icon_color: "#4287f5"
#                 on_release:
#                     app.add_tab()

#             MDSpinner:
#                 id: spinner
#                 size_hint: None, None
#                 size: dp(20), dp(20)
#                 pos_hint: {"center_x": .5, "center_y": .5}
#                 active: False

#             MDTextField:
#                 id: source
#                 hint_text: "source"
#                 icon_left: "magnify"
#                 font_size: dp(10)
#                 icon_size: dp(15)
#                 icon_left_color_normal: "#676767"
#                 icon_left_color_focus: "#4287f5"
#                 line_color_normal: "#4287f5"
#                 line_color_focus: "#676767"
#                 background_color: "#ffffff"

#             IconButtonAction:
#                 icon: "magnify"
#                 icon_size: dp(20)
#                 style: "tonal"
#                 theme_bg_color: "Custom"
#                 theme_icon_color: "Custom"
#                 pos_hint: {"center_y": .5}
#                 icon_color: "#4287f5"
#                 on_release: asynckivy.start(root.on_start_video())


#         MDBoxLayout:
#             orientation: "horizontal"
#             adaptive_height: True
#             spacing: "5dp"
#             md_bg_color: "#676767"

#             IconButtonAction:
#                 icon: "video-switch-outline"
#                 icon_size: dp(15)
#                 style: "tonal"
#                 theme_bg_color: "Custom"
#                 theme_icon_color: "Custom"
#                 icon_color: "#4287f5"
#                 on_release:
#                     root.camController.on_switch()

#             IconButtonAction:
#                 id: shape
#                 icon: "shape"
#                 icon_size: dp(15)
#                 style: "tonal"
#                 theme_bg_color: "Custom"
#                 theme_icon_color: "Custom"
#                 icon_color: "#4287f5"
#                 on_release: root.affiche_format()
            
#             MDLabel:
#                 id: label_format
#                 text: "[color=#4287f5]format[/color]"
#                 adaptive_height: True
#                 font_size: dp(15)
#                 size_hint_x: None
#                 width: dp(80)
#                 halign: "center"
#                 pos_hint: {"center_y": .33}
#                 markup: True

#             IconButtonAction:
#                 id: save
#                 icon: "content-save"
#                 icon_size: dp(15)
#                 style: "tonal"
#                 theme_bg_color: "Custom"
#                 theme_icon_color: "Custom"
#                 icon_color: "#4287f5"
#                 on_release:
#                     root.camController.on_record()

    # CardViewImage:
    #     id: cardImage
    #     camController: root.camController
    #     pos_hint: {"center_x": .5, "center_y": .45}
    #     size_hint: .7, .5


<ClickableTextFieldRound>:
    size_hint_y: None
    height: text_field.height
    padding: dp(10)
    
    MDTextField:

        id: text_field
        hint_text: root.hint_text
        icon_left: "magnify"
        font_size: dp(10)
        icon_left_color_normal: "#676767"
        icon_left_color_focus: "#4287f5"
        line_color_normal: "#4287f5"
        line_color_focus: "#4287f5"
        text: root.text
        helper_text_mode: "on_focus"    
        size_hint_x: None
        width: dp(250) 

    IconButtonAction:
        icon: "magnify"
        icon_size: dp(20)
        style: "tonal"
        theme_bg_color: "Custom"
        theme_icon_color: "Custom"
        icon_color: "#4287f5"
        on_release: asynckivy.start(app.on_start_video())
        pos_hint: {"center_y": .5}
        pos: text_field.width - self.width + dp(5), 0
        theme_text_color: "Hint"
